---
title: ""
author: ""
date: ""
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE, eval=FALSE)
```
#Functions

This module will cover: 

  - function syntax
  - control statements
  - logic statements
  
  
which will require the following skills already covered:

  - data structure 
  - assigning an object

***
##What is a function?
Functions incorporate sets of instructions that you want to use repeatedly or that, because of their complexity, are better self-contained in a script and called when needed.


You can write your own functions, but `R` and its packages come with "pre-made" functions as well.

Useful basic functions include include seq(), log(), sin()...

A typical function has the following architecture
```{r function, eval=FALSE}
func.name = function (arglist)  {body}
```

###**Practice**: Find and use a base R function

Choose a function from the below list of base R functions.

Use ?functionName in the console to read the documentation.

Run the function using your new-found knowledge in the space below.

Think of at least 1 real-world use of this function.

Be prepared to share your new knowledge!


- c
- cbind
- cumsum
- paste
- duplicated
- length
- names
- is.na
- rbind
- rm
- rowsums
- sd
- seq

```{r Try out a function}


```

##Example 1a: Simple function
```{r function1}
my.function1<-function(a,b,c){
 tmp<-a+b
 tmp2<-tmp/c
 return(tmp2)
}

#Using this function we have:
 out1<-my.function1(4,7,2)
 out1
```

###**Practice**: Choose other sets of numbers
```{r function2} 
out2<-my.function1(,,)
out2
```


###**Practice**: Create a function that will return the sum of 2 integers
```{r function15} 

my.function2 <- function(a,b){
  tmp <- a+b
  return(tmp)
}

my.function2(3,4)

```

##Example 1b: Rounding  function
```{r function13}
Roundme <- function(x){
   #this function uses the floor function to 
   #do what the round function does
   x <- x+0.5
   floor(x)
 }
```


##Example 2a: Control statements **if**

```{r function11}
x <- 8

if (x < 9) print("x is less than nine")
 
x <- 10

if (x < 9) print("x is less than nine")

```

##Example 2b: Control statements **if else**

```{r function3}
 a<-5
 if(a<1){
 b<-5
 c<-4
 } else {
 b<-10
 }
 b
```


###**Practice**: Uncomment and fill in a simple function with a nested if statement will print alternative outcomes

```{r function14}

Isit <- function(x){
  if (x == 1){
    print("x is 1")
  } else {
    print("x is not 1")
  }
}


Isit(1)

Isit(0)

```

##Example 2c: Control statements **while**
```{r function10}
x <- 2
while(x < 10){
 print(x)
 x <- x+1
}

print("The end")
```

##Example 3a:**for** loop

```{r function4}
a<-c() # creating an empty vector
 for(i in 1:10){ # i becomes 1 through 10 iteratively 
a[i]<-i^3  # this is the operation
 }
 a # seeing what the vector a becomes
```


###**Practice**: Write a for loop that makes a vector a that lists whether each value from 1-10 is even or odd 
Hints: 
- This will include an if else statement as well!
- The %% operator gives the remainder when a number is divided by another number
- so 2 %% 2 = 0; 5 %% 2 = 1

```{r for and if practice}
a <- c()
for( i in 1:10){
  tmp <- i%%2 ==0
  if(tmp == 0){
    a[i] <- "even"
  } else {
    a[i] <- "odd"
  }
  
}


```



##<span style="color:cadetblue">Example 4:</span> Random number generation

Here is an example, there are a number of distributions available
```{r function5} 

random_numbers<-rnorm(3,mean=5,sd=3) # normal distribution generates 3 numbers with a mean and a sd
random_numbers
```
 
##<span style="color:cadetblue">Example 5:</span> Descriptive stats 
```{r function6}  
dat<-rnorm(30,mean=5,sd=3) # creating a vector

dat # check it

sort (dat) #sort vector

unique (dat) #unique values

max(dat) #max

min(dat) #min

mean(dat) # taking the mean

sum(dat) # sum the vector elements

var(dat) # taking the variance

length(dat) # length of vector

sqrt(var(dat)/length(dat)) # standard error
```

###**Practice**: Write a function to compute standard error of dat

```{r function12}

stdError <- function(dat) {
  stdDev <- sd(dat)
  stdEr <- stdDev/sqrt(length(dat))
  return(stdEr)
}

```



##Example 6: The apply  function
```apply``` are functions to manipulate slices of data from matrices, arrays, lists and dataframes in a repetitive way 
```{r function7}  
X <- matrix(rnorm(30), nrow=5, ncol=6) # creating a matrix

# Sum the values of each column with `apply()`
apply(X, 2, sum)


```

###**Practice**: How do you calculate the sum of each row using apply?

```{r Row apply practice}

apply(X, 1, sum)

```

##Example 7: The lapply  function
```lapply``` applies a given function to every element of a list and obtain a list as result
```{r function8}  
# create a list with 2 elements
l <- list(a = 1:10, b = 11:20)

# the mean of the values in each element
lapply(l, mean)

# the sum of the values in each element
lapply(l, sum)

```

##Example 8: The sapply  function
```sapply``` will return either a vector, with elements [[‘a’]] and [[‘b’]], or a matrix with column names “a” and “b”
```{r function9}  
# create a list with 2 elements
l <- list(a = 1:10, b = 11:20)
# mean of values using sapply
l.mean <- sapply(l, mean)
# what type of object was returned?
class(l.mean)

# it's a numeric vector, so we can get element "a" like this
l.mean[['a']]

```



##Going further
rapply, tapply, parallel computing in R (https://www.r-bloggers.com/how-to-go-parallel-in-r-basics-tips/)
